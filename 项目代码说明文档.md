# è‹ç©¹å¤–å–é¡¹ç›®ä»£ç è¯´æ˜æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**ï¼šsky-take-outï¼ˆè‹ç©¹å¤–å–ï¼‰  
**é¡¹ç›®ç±»å‹**ï¼šåŸºäº Spring Boot çš„å¤–å–ç®¡ç†ç³»ç»Ÿ  
**æŠ€æœ¯æ ˆ**ï¼šSpring Boot 2.7.3 + MyBatis + MySQL + Redis + JWT + Knife4j  
**æ¶æ„æ¨¡å¼**ï¼šMaven å¤šæ¨¡å—é¡¹ç›®

---

## ğŸ—ï¸ é¡¹ç›®æ•´ä½“æ¶æ„

é¡¹ç›®é‡‡ç”¨ **Maven å¤šæ¨¡å—æ¶æ„**ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªå­æ¨¡å—ï¼š

```
sky-take-out (çˆ¶å·¥ç¨‹)
â”œâ”€â”€ sky-common   (å…¬å…±æ¨¡å—)
â”œâ”€â”€ sky-pojo     (å®ä½“ç±»æ¨¡å—)
â””â”€â”€ sky-server   (æœåŠ¡æ¨¡å—)
```

### æ¨¡å—ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      sky-take-out (çˆ¶å·¥ç¨‹)           â”‚
â”‚   ç®¡ç†ç‰ˆæœ¬ã€ä¾èµ–ã€æ„å»ºé…ç½®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚             â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sky-common â”‚ â”‚sky-pojo â”‚ â”‚ sky-server â”‚
â”‚  å…¬å…±å·¥å…·   â”‚ â”‚ å®ä½“ç±»  â”‚ â”‚  ä¸šåŠ¡é€»è¾‘   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â–²             â–²            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           sky-server ä¾èµ–ä¸¤è€…
```

---

## ğŸ“¦ æ¨¡å—è¯¦ç»†è¯´æ˜

### 1ï¸âƒ£ sky-commonï¼ˆå…¬å…±æ¨¡å—ï¼‰

**ä½œç”¨**ï¼šæä¾›é¡¹ç›®ä¸­æ‰€æœ‰é€šç”¨çš„å·¥å…·ç±»ã€å¸¸é‡ã€å¼‚å¸¸å¤„ç†ã€é…ç½®å±æ€§ç­‰ã€‚

#### ğŸ“‚ åŒ…ç»“æ„

| åŒ…å | è¯´æ˜ | ä¸»è¦ç±» |
|------|------|--------|
| `constant` | å¸¸é‡å®šä¹‰ | `MessageConstant`ï¼ˆé”™è¯¯ä¿¡æ¯ï¼‰<br>`StatusConstant`ï¼ˆçŠ¶æ€å¸¸é‡ï¼‰<br>`JwtClaimsConstant`ï¼ˆJWTå£°æ˜å¸¸é‡ï¼‰<br>`PasswordConstant`ï¼ˆå¯†ç å¸¸é‡ï¼‰<br>`AutoFillConstant`ï¼ˆè‡ªåŠ¨å¡«å……å¸¸é‡ï¼‰ |
| `context` | ä¸Šä¸‹æ–‡ç®¡ç† | `BaseContext`ï¼ˆThreadLocalå­˜å‚¨å½“å‰ç”¨æˆ·IDï¼‰ |
| `enumeration` | æšä¸¾ç±» | `OperationType`ï¼ˆæ“ä½œç±»å‹æšä¸¾ï¼šINSERT/UPDATEï¼‰ |
| `exception` | è‡ªå®šä¹‰å¼‚å¸¸ | `BaseException`ï¼ˆåŸºç¡€å¼‚å¸¸ç±»ï¼‰<br>`AccountNotFoundException`ï¼ˆè´¦å·ä¸å­˜åœ¨ï¼‰<br>`PasswordErrorException`ï¼ˆå¯†ç é”™è¯¯ï¼‰<br>`OrderBusinessException`ï¼ˆè®¢å•ä¸šåŠ¡å¼‚å¸¸ï¼‰<br>ç­‰12ä¸ªä¸šåŠ¡å¼‚å¸¸ç±» |
| `json` | JSONå¤„ç† | `JacksonObjectMapper`ï¼ˆè‡ªå®šä¹‰JSONåºåˆ—åŒ–é…ç½®ï¼‰ |
| `properties` | é…ç½®å±æ€§ | `JwtProperties`ï¼ˆJWTé…ç½®ï¼‰<br>`AliOssProperties`ï¼ˆé˜¿é‡Œäº‘OSSé…ç½®ï¼‰<br>`WeChatProperties`ï¼ˆå¾®ä¿¡é…ç½®ï¼‰ |
| `result` | ç»Ÿä¸€è¿”å›ç»“æœ | `Result<T>`ï¼ˆç»Ÿä¸€å“åº”å¯¹è±¡ï¼‰<br>`PageResult`ï¼ˆåˆ†é¡µç»“æœå¯¹è±¡ï¼‰ |
| `utils` | å·¥å…·ç±» | `JwtUtil`ï¼ˆJWTç”Ÿæˆä¸è§£æï¼‰<br>`AliOssUtil`ï¼ˆé˜¿é‡Œäº‘OSSæ–‡ä»¶ä¸Šä¼ ï¼‰<br>`HttpClientUtil`ï¼ˆHTTPè¯·æ±‚å·¥å…·ï¼‰<br>`WeChatPayUtil`ï¼ˆå¾®ä¿¡æ”¯ä»˜å·¥å…·ï¼‰ |

#### ğŸ”‘ æ ¸å¿ƒç±»è§£æ

**1. Result<T> - ç»Ÿä¸€è¿”å›ç»“æœ**
```java
@Data
public class Result<T> implements Serializable {
    private Integer code;  // 1=æˆåŠŸï¼Œ0=å¤±è´¥
    private String msg;    // é”™è¯¯ä¿¡æ¯
    private T data;        // è¿”å›æ•°æ®
}
```

**2. BaseContext - çº¿ç¨‹ä¸Šä¸‹æ–‡**
```java
// ä½¿ç”¨ ThreadLocal å­˜å‚¨å½“å‰ç™»å½•ç”¨æˆ·IDï¼Œé¿å…å±‚å±‚ä¼ é€’
public class BaseContext {
    public static ThreadLocal<Long> threadLocal = new ThreadLocal<>();
    public static void setCurrentId(Long id) { ... }
    public static Long getCurrentId() { ... }
}
```

**3. JwtUtil - JWTå·¥å…·**
- `createJWT()`ï¼šç”ŸæˆJWTä»¤ç‰Œ
- `parseJWT()`ï¼šè§£æJWTä»¤ç‰Œ

---

### 2ï¸âƒ£ sky-pojoï¼ˆå®ä½“ç±»æ¨¡å—ï¼‰

**ä½œç”¨**ï¼šå®šä¹‰æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼‰ã€å®ä½“ç±»ï¼ˆEntityï¼‰ã€è§†å›¾å¯¹è±¡ï¼ˆVOï¼‰ã€‚

#### ğŸ“‚ åŒ…ç»“æ„

| åŒ…å | è¯´æ˜ | å…¸å‹ç±» |
|------|------|--------|
| `dto` | æ•°æ®ä¼ è¾“å¯¹è±¡<br>ï¼ˆå®¢æˆ·ç«¯â†’æœåŠ¡ç«¯ï¼‰ | `EmployeeDTO`ï¼ˆå‘˜å·¥ä¿¡æ¯ï¼‰<br>`EmployeeLoginDTO`ï¼ˆå‘˜å·¥ç™»å½•ï¼‰<br>`DishDTO`ï¼ˆèœå“ä¿¡æ¯ï¼‰<br>`OrdersSubmitDTO`ï¼ˆè®¢å•æäº¤ï¼‰<br>ç­‰20ä¸ªDTOç±» |
| `entity` | æ•°æ®åº“å®ä½“ç±» | `Employee`ï¼ˆå‘˜å·¥ï¼‰<br>`Dish`ï¼ˆèœå“ï¼‰<br>`Setmeal`ï¼ˆå¥—é¤ï¼‰<br>`Orders`ï¼ˆè®¢å•ï¼‰<br>`User`ï¼ˆç”¨æˆ·ï¼‰<br>`Category`ï¼ˆåˆ†ç±»ï¼‰<br>ç­‰11ä¸ªå®ä½“ç±» |
| `vo` | è§†å›¾å¯¹è±¡<br>ï¼ˆæœåŠ¡ç«¯â†’å®¢æˆ·ç«¯ï¼‰ | `EmployeeLoginVO`ï¼ˆç™»å½•è¿”å›ï¼‰<br>`DishVO`ï¼ˆèœå“è¯¦æƒ…ï¼‰<br>`OrderVO`ï¼ˆè®¢å•è¯¦æƒ…ï¼‰<br>`BusinessDataVO`ï¼ˆè¥ä¸šæ•°æ®ï¼‰<br>ç­‰13ä¸ªVOç±» |

#### ğŸ” ä¸‰ç§å¯¹è±¡çš„åŒºåˆ«

| ç±»å‹ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| **DTO** | æ¥æ”¶å‰ç«¯è¯·æ±‚å‚æ•° | `EmployeeDTO` - æ–°å¢/ä¿®æ”¹å‘˜å·¥æ—¶ä¼ é€’çš„æ•°æ® |
| **Entity** | æ˜ å°„æ•°æ®åº“è¡¨ | `Employee` - å¯¹åº”æ•°æ®åº“ `employee` è¡¨ |
| **VO** | è¿”å›ç»™å‰ç«¯çš„æ•°æ® | `EmployeeLoginVO` - ç™»å½•æˆåŠŸåè¿”å›ï¼ˆåŒ…å«tokenï¼‰ |

#### ğŸ“ å®ä½“ç±»ç¤ºä¾‹

**Employeeï¼ˆå‘˜å·¥å®ä½“ï¼‰**
```java
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class Employee implements Serializable {
    private Long id;
    private String username;      // ç”¨æˆ·å
    private String name;          // å§“å
    private String password;      // å¯†ç 
    private String phone;         // æ‰‹æœºå·
    private String sex;           // æ€§åˆ«
    private String idNumber;      // èº«ä»½è¯å·
    private Integer status;       // çŠ¶æ€ï¼š1å¯ç”¨ 0ç¦ç”¨
    private LocalDateTime createTime;   // åˆ›å»ºæ—¶é—´
    private LocalDateTime updateTime;   // æ›´æ–°æ—¶é—´
    private Long createUser;      // åˆ›å»ºäººID
    private Long updateUser;      // æ›´æ–°äººID
}
```

**Ordersï¼ˆè®¢å•å®ä½“ï¼‰**
```java
@Data
public class Orders implements Serializable {
    // è®¢å•çŠ¶æ€å¸¸é‡
    public static final Integer PENDING_PAYMENT = 1;      // å¾…ä»˜æ¬¾
    public static final Integer TO_BE_CONFIRMED = 2;      // å¾…æ¥å•
    public static final Integer CONFIRMED = 3;            // å·²æ¥å•
    public static final Integer DELIVERY_IN_PROGRESS = 4; // æ´¾é€ä¸­
    public static final Integer COMPLETED = 5;            // å·²å®Œæˆ
    public static final Integer CANCELLED = 6;            // å·²å–æ¶ˆ
    
    // æ”¯ä»˜çŠ¶æ€å¸¸é‡
    public static final Integer UN_PAID = 0;   // æœªæ”¯ä»˜
    public static final Integer PAID = 1;      // å·²æ”¯ä»˜
    public static final Integer REFUND = 2;    // é€€æ¬¾
    
    private Long id;
    // ...å…¶ä»–å­—æ®µ
}
```

---

### 3ï¸âƒ£ sky-serverï¼ˆæœåŠ¡æ¨¡å—ï¼‰

**ä½œç”¨**ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚ï¼ŒåŒ…å«æ§åˆ¶å™¨ã€æœåŠ¡ã€æ•°æ®è®¿é—®ç­‰ã€‚

#### ğŸ“‚ åŒ…ç»“æ„

| åŒ…å | è¯´æ˜ | ä¸»è¦å†…å®¹ |
|------|------|----------|
| `config` | é…ç½®ç±» | `WebMvcConfiguration`ï¼ˆWebé…ç½®ã€æ‹¦æˆªå™¨æ³¨å†Œã€Knife4jé…ç½®ï¼‰ |
| `controller` | æ§åˆ¶å™¨å±‚ | `admin/`ï¼ˆç®¡ç†ç«¯æ§åˆ¶å™¨ï¼‰<br>- `EmployeeController`ï¼ˆå‘˜å·¥ç®¡ç†ï¼‰ |
| `service` | æœåŠ¡æ¥å£å±‚ | `EmployeeService`ï¼ˆå‘˜å·¥æœåŠ¡æ¥å£ï¼‰ |
| `service.impl` | æœåŠ¡å®ç°å±‚ | `EmployeeServiceImpl`ï¼ˆå‘˜å·¥æœåŠ¡å®ç°ï¼‰ |
| `mapper` | æ•°æ®è®¿é—®å±‚ | `EmployeeMapper`ï¼ˆMyBatis Mapperæ¥å£ï¼‰ |
| `handler` | å¼‚å¸¸å¤„ç†å™¨ | `GlobalExceptionHandler`ï¼ˆå…¨å±€å¼‚å¸¸å¤„ç†ï¼‰ |
| `interceptor` | æ‹¦æˆªå™¨ | `JwtTokenAdminInterceptor`ï¼ˆJWTä»¤ç‰Œæ ¡éªŒæ‹¦æˆªå™¨ï¼‰ |

#### ğŸ”„ ä¸šåŠ¡æµç¨‹åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¢æˆ·ç«¯ï¼ˆå‰ç«¯/ç§»åŠ¨ç«¯ï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ HTTPè¯·æ±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Controller å±‚ï¼ˆæ§åˆ¶å™¨ï¼‰                  â”‚
â”‚  - æ¥æ”¶è¯·æ±‚å‚æ•°                           â”‚
â”‚  - å‚æ•°æ ¡éªŒ                               â”‚
â”‚  - è°ƒç”¨Serviceå±‚                          â”‚
â”‚  - è¿”å›ç»Ÿä¸€ç»“æœ Result<T>                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰                   â”‚
â”‚  - ä¸šåŠ¡è§„åˆ™æ ¡éªŒ                           â”‚
â”‚  - äº‹åŠ¡ç®¡ç†                               â”‚
â”‚  - è°ƒç”¨Mapperå±‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mapper å±‚ï¼ˆæ•°æ®è®¿é—®ï¼‰                    â”‚
â”‚  - MyBatis SQLæ˜ å°„                       â”‚
â”‚  - ä¸æ•°æ®åº“äº¤äº’                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Databaseï¼ˆMySQLæ•°æ®åº“ï¼‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ¯ å…¸å‹ä¸šåŠ¡æµç¨‹ç¤ºä¾‹ï¼šå‘˜å·¥ç™»å½•

**1. Controllerå±‚ï¼ˆEmployeeController.javaï¼‰**
```java
@RestController
@RequestMapping("/admin/employee")
public class EmployeeController {
    @Autowired
    private EmployeeService employeeService;
    
    @PostMapping("/login")
    public Result<EmployeeLoginVO> login(@RequestBody EmployeeLoginDTO dto) {
        // 1. è°ƒç”¨Serviceå±‚æ‰§è¡Œç™»å½•
        Employee employee = employeeService.login(dto);
        
        // 2. ç”ŸæˆJWTä»¤ç‰Œ
        String token = JwtUtil.createJWT(...);
        
        // 3. æ„é€ è¿”å›å¯¹è±¡
        EmployeeLoginVO vo = EmployeeLoginVO.builder()
            .id(employee.getId())
            .token(token)
            .build();
        
        // 4. è¿”å›ç»Ÿä¸€ç»“æœ
        return Result.success(vo);
    }
}
```

**2. Serviceå±‚ï¼ˆEmployeeServiceImpl.javaï¼‰**
```java
@Service
public class EmployeeServiceImpl implements EmployeeService {
    @Autowired
    private EmployeeMapper employeeMapper;
    
    public Employee login(EmployeeLoginDTO dto) {
        // 1. æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢æ•°æ®åº“
        Employee employee = employeeMapper.getByUsername(dto.getUsername());
        
        // 2. æ ¡éªŒè´¦å·æ˜¯å¦å­˜åœ¨
        if (employee == null) {
            throw new AccountNotFoundException(MessageConstant.ACCOUNT_NOT_FOUND);
        }
        
        // 3. æ ¡éªŒå¯†ç 
        String password = DigestUtils.md5DigestAsHex(dto.getPassword().getBytes());
        if (!password.equals(employee.getPassword())) {
            throw new PasswordErrorException(MessageConstant.PASSWORD_ERROR);
        }
        
        // 4. æ ¡éªŒè´¦å·çŠ¶æ€
        if (employee.getStatus() == StatusConstant.DISABLE) {
            throw new AccountLockedException(MessageConstant.ACCOUNT_LOCKED);
        }
        
        return employee;
    }
}
```

**3. Mapperå±‚ï¼ˆEmployeeMapper.java + EmployeeMapper.xmlï¼‰**
```java
@Mapper
public interface EmployeeMapper {
    Employee getByUsername(String username);
}
```

```xml
<!-- EmployeeMapper.xml -->
<select id="getByUsername" resultType="Employee">
    SELECT * FROM employee WHERE username = #{username}
</select>
```

---

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯ç»„ä»¶è¯´æ˜

### 1. JWT è®¤è¯æœºåˆ¶

**æµç¨‹**ï¼š
```
1. ç”¨æˆ·ç™»å½• â†’ éªŒè¯æˆåŠŸ â†’ ç”ŸæˆJWTä»¤ç‰Œ â†’ è¿”å›ç»™å®¢æˆ·ç«¯
2. åç»­è¯·æ±‚ â†’ æºå¸¦JWTä»¤ç‰Œï¼ˆHeader: tokenï¼‰
3. æ‹¦æˆªå™¨æ‹¦æˆª â†’ è§£æJWT â†’ æå–ç”¨æˆ·ID â†’ å­˜å…¥ThreadLocal
4. ä¸šåŠ¡å±‚é€šè¿‡ BaseContext.getCurrentId() è·å–å½“å‰ç”¨æˆ·ID
```

**ç›¸å…³ç±»**ï¼š
- `JwtUtil`ï¼šç”Ÿæˆå’Œè§£æJWT
- `JwtTokenAdminInterceptor`ï¼šæ‹¦æˆªå™¨æ ¡éªŒJWT
- `BaseContext`ï¼šå­˜å‚¨å½“å‰è¯·æ±‚ç”¨æˆ·ID

---

### 2. å…¨å±€å¼‚å¸¸å¤„ç†

**GlobalExceptionHandler.java**
```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    // æ•è·è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
    @ExceptionHandler(BaseException.class)
    public Result exceptionHandler(BaseException ex) {
        return Result.error(ex.getMessage());
    }
    
    // æ•è·SQLå¼‚å¸¸
    @ExceptionHandler(SQLIntegrityConstraintViolationException.class)
    public Result exceptionHandler(SQLIntegrityConstraintViolationException ex) {
        // å¤„ç†å”¯ä¸€ç´¢å¼•å†²çªç­‰
        return Result.error("æ•°æ®é‡å¤");
    }
}
```

---

### 3. ç»Ÿä¸€è¿”å›ç»“æœå°è£…

æ‰€æœ‰æ¥å£è¿”å› `Result<T>` å¯¹è±¡ï¼š

```json
// æˆåŠŸç¤ºä¾‹
{
  "code": 1,
  "msg": null,
  "data": {
    "id": 1,
    "username": "admin",
    "token": "eyJhbGciOiJIUzI1NiJ9..."
  }
}

// å¤±è´¥ç¤ºä¾‹
{
  "code": 0,
  "msg": "è´¦å·ä¸å­˜åœ¨",
  "data": null
}
```

---

### 4. MyBatis é…ç½®

**application.yml**
```yaml
mybatis:
  mapper-locations: classpath:mapper/*.xml  # Mapper XMLæ–‡ä»¶ä½ç½®
  type-aliases-package: com.sky.entity      # å®ä½“ç±»åŒ…è·¯å¾„
  configuration:
    map-underscore-to-camel-case: true      # å¼€å¯é©¼å³°å‘½åè½¬æ¢
```

---

### 5. æ‹¦æˆªå™¨é…ç½®

**WebMvcConfiguration.java**
```java
@Configuration
public class WebMvcConfiguration extends WebMvcConfigurationSupport {
    
    @Autowired
    private JwtTokenAdminInterceptor jwtTokenAdminInterceptor;
    
    protected void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(jwtTokenAdminInterceptor)
                .addPathPatterns("/admin/**")          // æ‹¦æˆªæ‰€æœ‰ç®¡ç†ç«¯æ¥å£
                .excludePathPatterns("/admin/employee/login");  // æ’é™¤ç™»å½•æ¥å£
    }
}
```

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡ï¼ˆæ¨æµ‹ï¼‰

æ ¹æ®å®ä½“ç±»æ¨æµ‹æ•°æ®åº“è¡¨ç»“æ„ï¼š

| è¡¨å | è¯´æ˜ | ä¸»è¦å­—æ®µ |
|------|------|----------|
| `employee` | å‘˜å·¥è¡¨ | id, username, password, name, phone, status |
| `user` | ç”¨æˆ·è¡¨ | id, openid, name, phone, avatar |
| `category` | åˆ†ç±»è¡¨ | id, type, name, sort |
| `dish` | èœå“è¡¨ | id, name, category_id, price, image, status |
| `dish_flavor` | èœå“å£å‘³è¡¨ | id, dish_id, name, value |
| `setmeal` | å¥—é¤è¡¨ | id, name, category_id, price, image, status |
| `setmeal_dish` | å¥—é¤èœå“å…³ç³»è¡¨ | id, setmeal_id, dish_id, copies |
| `orders` | è®¢å•è¡¨ | id, number, status, user_id, amount |
| `order_detail` | è®¢å•æ˜ç»†è¡¨ | id, order_id, dish_id, amount |
| `shopping_cart` | è´­ç‰©è½¦è¡¨ | id, user_id, dish_id, setmeal_id, amount |
| `address_book` | åœ°å€ç°¿è¡¨ | id, user_id, consignee, phone, detail |

---

## ğŸ” å…³é”®é…ç½®è¯´æ˜

### application.ymlï¼ˆä¸»é…ç½®ï¼‰

```yaml
server:
  port: 8080

spring:
  profiles:
    active: dev  # æ¿€æ´»å¼€å‘ç¯å¢ƒé…ç½®
  datasource:
    druid:
      driver-class-name: com.mysql.cj.jdbc.Driver
      url: jdbc:mysql://localhost:3306/sky_take_out
      username: root
      password: 123456
```

---

## ğŸ“š ä¸»è¦æŠ€æœ¯æ ˆç‰ˆæœ¬

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Spring Boot | 2.7.3 | åŸºç¡€æ¡†æ¶ |
| MyBatis | 2.2.0 | ORMæ¡†æ¶ |
| Lombok | 1.18.30 | ç®€åŒ–ä»£ç  |
| Druid | 1.2.1 | æ•°æ®åº“è¿æ¥æ±  |
| PageHelper | 1.3.0 | åˆ†é¡µæ’ä»¶ |
| Knife4j | 3.0.2 | æ¥å£æ–‡æ¡£ |
| JWT | 0.9.1 | è®¤è¯æˆæƒ |
| Fastjson | 1.2.76 | JSONå¤„ç† |
| AliOSS | 3.10.2 | æ–‡ä»¶ä¸Šä¼  |
| WeChat Pay | 0.4.8 | å¾®ä¿¡æ”¯ä»˜ |

---

## ğŸ¯ é¡¹ç›®åŠŸèƒ½æ¨¡å—ï¼ˆæ¨æµ‹ï¼‰

æ ¹æ®ä»£ç ç»“æ„æ¨æµ‹ç³»ç»ŸåŠŸèƒ½ï¼š

### ç®¡ç†ç«¯ï¼ˆ/adminï¼‰
- å‘˜å·¥ç®¡ç†ï¼šç™»å½•ã€æ–°å¢ã€ä¿®æ”¹ã€åˆ†é¡µæŸ¥è¯¢
- åˆ†ç±»ç®¡ç†ï¼šèœå“åˆ†ç±»ã€å¥—é¤åˆ†ç±»
- èœå“ç®¡ç†ï¼šèœå“CRUDã€èµ·å”®åœå”®ã€å£å‘³ç®¡ç†
- å¥—é¤ç®¡ç†ï¼šå¥—é¤CRUDã€å¥—é¤èœå“å…³è”
- è®¢å•ç®¡ç†ï¼šè®¢å•æŸ¥è¯¢ã€æ¥å•ã€æ´¾é€ã€å®Œæˆã€å–æ¶ˆ
- æ•°æ®ç»Ÿè®¡ï¼šè¥ä¸šæ•°æ®ã€è®¢å•ç»Ÿè®¡ã€é”€å”®æ’è¡Œ

### ç”¨æˆ·ç«¯ï¼ˆæ¨æµ‹ï¼‰
- ç”¨æˆ·ç™»å½•ï¼šå¾®ä¿¡æˆæƒç™»å½•
- èœå“æµè§ˆï¼šåˆ†ç±»æµè§ˆã€æœç´¢
- è´­ç‰©è½¦ï¼šæ·»åŠ ã€åˆ é™¤ã€æ¸…ç©º
- åœ°å€ç®¡ç†ï¼šæ”¶è´§åœ°å€CRUD
- è®¢å•ç®¡ç†ï¼šä¸‹å•ã€æ”¯ä»˜ã€æŸ¥è¯¢ã€å–æ¶ˆ

---

## ğŸš€ é¡¹ç›®å¯åŠ¨æµç¨‹

1. **æ•°æ®åº“å‡†å¤‡**ï¼šåˆ›å»º `sky_take_out` æ•°æ®åº“å¹¶å¯¼å…¥SQLè„šæœ¬
2. **é…ç½®ä¿®æ”¹**ï¼šä¿®æ”¹ `application-dev.yml` ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯
3. **Mavenæ„å»º**ï¼š`mvn clean install`
4. **å¯åŠ¨é¡¹ç›®**ï¼šè¿è¡Œ `SkyApplication.main()`
5. **è®¿é—®æ¥å£æ–‡æ¡£**ï¼š`http://localhost:8080/doc.html`ï¼ˆKnife4jï¼‰

---

## ğŸ“Œ ä»£ç è§„èŒƒä¸çº¦å®š

### 1. å‘½åè§„èŒƒ
- **Controller**ï¼šä»¥ `Controller` ç»“å°¾ï¼Œå¦‚ `EmployeeController`
- **Service**ï¼šä»¥ `Service` ç»“å°¾ï¼Œå¦‚ `EmployeeService`
- **Mapper**ï¼šä»¥ `Mapper` ç»“å°¾ï¼Œå¦‚ `EmployeeMapper`
- **DTO**ï¼šä»¥ `DTO` ç»“å°¾ï¼Œå¦‚ `EmployeeDTO`
- **VO**ï¼šä»¥ `VO` ç»“å°¾ï¼Œå¦‚ `EmployeeLoginVO`

### 2. æ³¨è§£ä½¿ç”¨
- `@RestController`ï¼šRESTfulæ§åˆ¶å™¨
- `@Service`ï¼šæœåŠ¡å±‚
- `@Mapper`ï¼šMyBatis Mapper
- `@Data`ï¼šLombokè‡ªåŠ¨ç”Ÿæˆgetter/setter
- `@Builder`ï¼šå»ºé€ è€…æ¨¡å¼
- `@Slf4j`ï¼šæ—¥å¿—æ³¨è§£

### 3. å¼‚å¸¸å¤„ç†
- ä¸šåŠ¡å¼‚å¸¸ç»§æ‰¿ `BaseException`
- ä½¿ç”¨ `GlobalExceptionHandler` ç»Ÿä¸€æ•è·å¤„ç†
- è¿”å›æ ‡å‡† `Result` å¯¹è±¡

### 4. è¿”å›æ ¼å¼
- æ‰€æœ‰æ¥å£ç»Ÿä¸€è¿”å› `Result<T>`
- æˆåŠŸï¼š`code=1`ï¼Œå¤±è´¥ï¼š`code=0`

---

## ğŸ” å¸¸è§é—®é¢˜è¯´æ˜

### Q1: DTOã€Entityã€VO çš„åŒºåˆ«ï¼Ÿ
- **DTO**ï¼šæ¥æ”¶å‰ç«¯å‚æ•°ï¼Œå¦‚æ–°å¢å‘˜å·¥æ—¶çš„è¡¨å•æ•°æ®
- **Entity**ï¼šå¯¹åº”æ•°æ®åº“è¡¨ï¼ŒåŒ…å«æ‰€æœ‰å­—æ®µ
- **VO**ï¼šè¿”å›ç»™å‰ç«¯ï¼Œå¯èƒ½åŒ…å«å¤šè¡¨å…³è”æ•°æ®æˆ–æ’é™¤æ•æ„Ÿå­—æ®µ

### Q2: BaseContext çš„ä½œç”¨ï¼Ÿ
ç”¨ ThreadLocal å­˜å‚¨å½“å‰ç™»å½•ç”¨æˆ·IDï¼Œé¿å…åœ¨æ–¹æ³•é—´å±‚å±‚ä¼ é€’ç”¨æˆ·ä¿¡æ¯ã€‚

### Q3: ä¸ºä»€ä¹ˆä½¿ç”¨å¤šæ¨¡å—æ¶æ„ï¼Ÿ
- **è§£è€¦**ï¼šå…¬å…±ä»£ç ã€å®ä½“ç±»ã€ä¸šåŠ¡é€»è¾‘åˆ†ç¦»
- **å¤ç”¨**ï¼šcommon å’Œ pojo å¯è¢«å¤šä¸ªæœåŠ¡æ¨¡å—å¼•ç”¨
- **ç»´æŠ¤**ï¼šèŒè´£æ¸…æ™°ï¼Œä¾¿äºå›¢é˜Ÿåä½œ

### Q4: Knife4j æ˜¯ä»€ä¹ˆï¼Ÿ
Swagger çš„å¢å¼ºå·¥å…·ï¼Œè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œè®¿é—® `/doc.html` å³å¯æŸ¥çœ‹å’Œæµ‹è¯•æ¥å£ã€‚

---

## ğŸ“– å­¦ä¹ å»ºè®®

### æ–°æ‰‹ç†è§£é¡ºåºï¼š
1. å…ˆçœ‹ **pom.xml** äº†è§£é¡¹ç›®ä¾èµ–å’Œæ¨¡å—å…³ç³»
2. å†çœ‹ **å®ä½“ç±»ï¼ˆEntityï¼‰** ç†è§£æ•°æ®åº“è¡¨ç»“æ„
3. ç„¶åçœ‹ **DTO/VO** ç†è§£å‰åç«¯æ•°æ®ä¼ è¾“
4. æ¥ç€çœ‹ **Serviceå±‚** ç†è§£ä¸šåŠ¡é€»è¾‘
5. æœ€åçœ‹ **Controllerå±‚** ç†è§£æ¥å£å®šä¹‰

### è°ƒè¯•æŠ€å·§ï¼š
1. åœ¨ Controller æ‰“æ–­ç‚¹ï¼Œè§‚å¯Ÿè¯·æ±‚å‚æ•°
2. åœ¨ Service æ‰“æ–­ç‚¹ï¼Œè§‚å¯Ÿä¸šåŠ¡é€»è¾‘æ‰§è¡Œ
3. æŸ¥çœ‹ Mapper XMLï¼Œç†è§£SQLæ‰§è¡Œ
4. ä½¿ç”¨ Knife4j æµ‹è¯•æ¥å£

---

## ğŸ“ æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ **Spring Boot + MyBatis** å¤–å–ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ï¼š
- âœ… **å¤šæ¨¡å—æ¶æ„**ï¼šåˆ†ç¦»å…¬å…±ã€å®ä½“ã€ä¸šåŠ¡
- âœ… **RESTful API**ï¼šç»Ÿä¸€è¿”å›æ ¼å¼
- âœ… **JWTè®¤è¯**ï¼šæ— çŠ¶æ€èº«ä»½éªŒè¯
- âœ… **å…¨å±€å¼‚å¸¸å¤„ç†**ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†
- âœ… **Lombokç®€åŒ–ä»£ç **ï¼šå‡å°‘å†—ä½™ä»£ç 
- âœ… **MyBatisæŒä¹…åŒ–**ï¼šçµæ´»çš„SQLæ˜ å°„
- âœ… **æ¥å£æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ**ï¼šKnife4j

é€‚åˆå­¦ä¹  Spring Boot é¡¹ç›®å¼€å‘æµç¨‹å’Œä¼ä¸šçº§ä»£ç è§„èŒƒï¼

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**ï¼š2025-12-24  
**é¡¹ç›®ç‰ˆæœ¬**ï¼š1.0-SNAPSHOT

